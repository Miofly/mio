<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport"
		  content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	<meta content="yes" name="apple-mobile-web-app-capable"/>
	<meta content="black" name="apple-mobile-web-app-status-bar-style"/>
	<meta content="telephone=no" name="format-detection"/>
	<meta content="email=no" name="format-detection"/>
	<title>.</title>
	<link rel="stylesheet" type="text/css" href="./index.css"/>
	<script type="text/javascript" src="./js/jquery.js"></script>
	<script type="text/javascript" src="./js/adaptive.js"></script>
	<script type="text/javascript" src="./js/zepto.js"></script>
	<script type="text/javascript" src="./js/tvp.js"></script>
	<script type="text/javascript" src="./js/jsmpeg.min.js"></script>
	<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
	<style>
		.a1 {
			animation: scale-small 1s linear 0s infinite alternate
		}
		/*.txp_ad,.txp_none,.txp_overlay_error{display: none}*/
	</style>
</head>
<body style="background: black">
<!--跳广告-->
<div id="test1">

	<div onclick="location.href = ''">
		<img src="img/xiaochengxun@2x.png" style="width: 100%">
	</div>
	<div style="display: flex;align-items: center;justify-content: space-between;margin-top: 0.05rem;">
		<div style="width: 0.94rem;height: 0.94rem;border-radius: 50%;margin-left: 0.2rem;text-align: left">
			<img src="../../img/xtx/10.jpg" style="animation: rotate 5s linear 0s infinite;width: 0.94rem;height: 0.94rem;border-radius: 50%">
			<span style="color: white;font-size: 0.21rem;width: 200px;display: inline-block">美女直播TEST</span>
		</div>

		<div style="width:1.78rem;height:0.41rem;background:rgba(255,81,4,1);font-size: 0.19rem;color:rgba(255,255,255,1);
	border-radius:0.05rem;text-align: center;line-height: 0.41rem;margin-left: 0.10rem">
			直播中...
		</div>

		<div style="width:0.41rem;height:0.41rem;margin-right: 0.16rem;background:rgba(55,58,69,1);
	border-radius:0.05rem;line-height: 0.41rem;text-align: center">
			<img src="img/qianjin@2x.png" style="animation: moveLeft 1s linear 0s infinite alternate;width: 0.21rem;height: 0.22rem;">
		</div>
	</div>

	<div style="font-size:0.18rem;color:rgba(255,255,255,1);line-height:0.25rem;text-align: left;width: 86%;margin-left: 7%;margin-top: 13%">
		每天定时直播，不同美女不同时段直播<br>
		点击“直播中”红色按钮<br>
		哥哥，快来看我直播吧～
	</div>

	<div style="width: 100%;text-align: center;font-size: 0.27rem;color: white;margin: 0.3rem 0">
		作品6
	</div>
</div>

<div class="video-wrap" style="width: 100%">
	<img class="allShow" id="test" src="img/back.png" onclick="backIndex()"
		 style="display: none;position: fixed;top: 10px;left: 10px;width: 0.5rem;z-index: 9999999999999">
	<div class="allShow" id="mod_player" style="display: none;height: 100%;width: 100%"></div>
</div>

<div style="text-align: center;position: relative;width: 100%;" id="parLists">
	<img id="shou" src="img/shou@2x.png" onclick="getVideo(0)" style="animation: scale-up 1s linear 0s infinite alternate;position: absolute;top: 0.8rem;left: 22%;width: 0.47rem;height: 0.58rem;z-index: 999">
</div>

<script>
    var list = [
        {vid: 'r09779c7gd4', pic: '../../img/xtx/11.jpg', delayTime: '115'},
        {vid: 'n0951vjpvkl', pic: '../../img/xtx/2.jpg', delayTime: '1110'},
        {vid: 'i0975w0af8a', pic: '../../img/xtx/3.jpg', delayTime: '1115'},
        {vid: 'q097606n0v6', pic: '../../img/xtx/4.jpg', delayTime: '1110'},
        {vid: 'l0975w9qbee', pic: '../../img/xtx/5.jpg', delayTime: '115'},
        {vid: 'i0975qgpym8', pic: '../../img/xtx/6.jpg', delayTime: '113'},
    ]
    var html = ''
    $.each(list, function (key) {
        html += '<div onclick="getVideo(' + key + ')" style="width: 46%;height: 46%;position: relative;float: left;margin-left: 2%;margin-right: 2%;text-align: center">' +
            '<img id="'+ 'img' + key + '" style="width: 100%;height: 100%;" ' +
            'vid="' + list[key].vid + '" src="' + list[key].pic + '">' +
            '<img src="img/bofang@2x.png" style="position: absolute;left: 35%;top: 35%;width: 0.54rem;height: 0.54rem"></div>'
    })
    $('#parLists').append(html)

	$('#img0').addClass('a1')

    // function getVideo(key) {
    //     $('#shou').hide()
    //     //
    //     //     console.log('播放的视频', '第' + key + '个', 'id为：' + list[key].vid)
    //     //
    //         $('.allShow').show()
    //     video.setVid(list[1].vid);
    //     // var player = new tvp.Player(300, 200);
    //     var player = new tvp.Player('100%', '100vh');
    //     console.log(player)
    //     player.setCurVideo(video);
    //     player.addParam("autoplay", true);
    //     // player.addParam("pic", tvp.common.getVideoSnapMobile(vid));
    //     player.write('mod_player');
	// }
    function getVideo(key) {
        var video = new tvp.VideoInfo();

        $('#shou').hide()
        $('#test1').hide()
        $('.allShow').show()
        video.setVid(list[key].vid)
        var player = new tvp.Player('100%', '100vh');

        player.setCurVideo(video);
        player.addParam("autoplay", true);
        player.write('mod_player');
        // document.addEventListener('WeixinJSBridgeReady', function () { // 安卓自动播放
        //     player.play();
        // }, false);

        video.setHistoryStart(3);

		player.onready = function () {
            video.setHistoryStart(1);
            player.setPlaytime(0)

        }

        // var temp = 'a'
        player.onplay = function() {
            console.log(video)
            console.log(player)
            // video.setHistoryStart(1);
            player.setPlaytime(0)

            // console.log(1231)
                // video.setHistoryStart(3);
			// player.setPlaytime(3)
        }


        var tempVar = 'c'

        player.on('timeupdate', (parmas) => {
            // if (tempVar == 'c') {
            //     console.log(12312)
            //     video.setHistoryStart(0);
            //     player.setPlaytime(0)
			// 	tempVar = 'ccc'
            // }
            // if (parmas.videoTag.currentTime < 1) {} // 可做跳转

            if (key == getUrlParam('key') && temp == 'a') { // 分享完成从断点播放
                setTimeout(() => {
                    parmas.videoTag.currentTime = list[key].delayTime
                }, 100)
                temp = 'b'
            }

            if (player.getCurrentTime() == player.getDuration()) {
                $('#test').click()
                console.log('视频播放结束事件')
            }

            if (parmas.videoTag.currentTime >= list[key].delayTime && key != getUrlParam('key')) {
                player.pause();
                // location.href = 'http://192.168.3.106:8888/mio/src/html/project/newVideo/share.html?key=' + key + ''
                console.log('断点处跳转')
            }
        })
    }

    // var player = new Txplayer({
    //     containerId: 'mod_player',
    //     vid: list[1].vid,
    //     width: '100%', // 数值600
    //     height: '100%',
    //     // height: screen.availHeight / 1.5,
    //     // autoplay: true,
    //     // playStartTime: 200,
    //     isUsePreload: true, // 是否预加载
    //     // useMiniSkin: true,
    //     miniSkinAdaptive: true,
    //     // poster: obj.pic,
    //     showBullet: true,
    //     showBulletInput: true
    // });
    // // var _playStatus = 1
    // // if (location.href.indexOf('key') > -1) {
    // //     _playStatus = 'continue';
    // // }
    // player.on('ready', () => {
    //     if (location.href.indexOf('key') > -1) {
    //         getVideo(getUrlParam('key'))
    //     }
    //     player.enterBrowserFullscreen(); // 全屏播放
    // });
	//
	//


    function backIndex() {
        $('.allShow').hide()
		$('#img0').removeClass('a1')
        // player.pause();
    }

    function getUrlParam(name) { // 获取地址栏参数
        var reg = new RegExp(`(^|&)${name}=([^&]*)(&|$)`) // 构造一个含有目标参数的正则表达式对象
        var r = window.location.search.substr(1).match(reg)// 匹配目标参数
        if (r != null) return unescape(r[2])
        return null // 返回参数值
    }
</script>
</body>
</html>
