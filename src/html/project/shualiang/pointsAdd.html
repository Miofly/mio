<!DOCTYPE html>
<!-- saved from url=(0055)http://ja.bigliang.cn/wxTask/dashboard/pointsAdd.action -->
<html style=""
	  class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers no-applicationcache svg inlinesvg smil svgclippaths">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


	<meta name="renderer" content="webkit">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	<meta name="description" content="A fully featured admin theme which can be used to build CRM, CMS, etc.">
	<meta name="author" content="Coderthemes">

	<title>积分充值</title>
	<link href="./css/select2.css" rel="stylesheet" type="text/css">
	<link href="./css/select2-bootstrap.css" rel="stylesheet" type="text/css">
	<link href="./css/multi-select.css" rel="stylesheet" type="text/css">
	<link href="./css/sweetalert.css" rel="stylesheet" type="text/css">
	<link href="./css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="./css/core.css" rel="stylesheet" type="text/css">
	<link href="./css/icons.css" rel="stylesheet" type="text/css">
	<link href="./css/components.css" rel="stylesheet" type="text/css">
	<link href="./css/pages.css" rel="stylesheet" type="text/css">
	<link href="./css/menu.css" rel="stylesheet" type="text/css">
	<link href="./css/responsive.css" rel="stylesheet" type="text/css">
	<script src="./js/modernizr.min.js"></script>
	<style type="text/css">
		.bg-custom {
			background-color: #e0b40e !important;
		}

		* {
			box-sizing: border-box;
		}

		body, html {
			margin: 0;
			padding: 0;
		}

		body {
			padding-top: 50px;
		}

		.fs-fixed-top {
			position: fixed;
			top: 0;
			left: 0;
			z-index: 10000;
			width: 100%;
			height: 50px;
			line-height: 48px;
			text-align: center;
			background-color: #fff;
			border-bottom: 1px solid #ddd;
		}

		.fs-fixed-top .title {
			margin: 0;
			font-size: 14px;
			font-weight: 700;
		}

		.demo-content {
			height: 200px;
		}

		.back-btn {
			position: absolute;
			left: 12px;
			top: 15px;
			z-index: 1000;
			font-size: 0;
			display: inline-block;
			width: 20px;
			height: 20px;
			line-height: 1;
		}

		.back-btn img {
			width: 20px;
			height: 20px;
			display: inline-block;
		}
	</style>
</head>
<body class="fixed-left widescreen">
<div class="fs-fixed-top">
	<a href="main.html" class="back-btn">
		<img src="./img/back.png">
	</a>
	<p class="title">积分充值</p>
</div>
<div id="wrapper">
	<div class="content-page" style="margin-left:0px;">
		<!-- Start content -->
		<div class="content"
			 style="margin-bottom:0px;margin-top:0px;padding-top:10px;padding-left:0px;padding-right:0px;">
			<div class="container" style="padding-left:10px;padding-right:10px;">
				<div class="row">
					<div class="col-sm-12">
						<div class="panel panel-default">
							<div class="panel-body">
								<form id="pointsForm" class="form-horizontal" method="post" role="form" >
									<div class="form-group">
										<label class="col-md-12 control-label">当前积分：&nbsp;&nbsp;&nbsp;<span
												id="myPonits" class="pull-right"></span></label>
									</div>
									<div class="form-group">
										<label class="col-md-12 control-label">充值用户：&nbsp;&nbsp;&nbsp;<span id="myName"
																											class="pull-right"></span></label>
									</div>
									<div class="form-group">
										<label class="col-md-2 control-label">积分：</label>
										<div class="col-md-10">
											<select id="points" name="points" class="select2 form-control">
												<option value="">请选择</option>
											</select>
										</div>
									</div>

									<div class="form-group">
										<div class="col-sm-12">
											<button type="button" onclick="showDetail();"
													class="btn btn-warning waves-effect waves-light" style="width:100%">
												充值记录
											</button>
										</div>
									</div>
									<div class="form-group">
										<div class="col-sm-12">
											<button type="button" onclick="doSave();"
													class="btn btn-info waves-effect waves-light" style="width:100%">充值
											</button>
										</div>
									</div>
								</form>
							</div> <!-- panel-body -->
						</div> <!-- panel -->
					</div> <!-- col -->
				</div> <!-- End row -->
			</div> <!-- container -->
		</div> <!-- content -->
	</div>
</div>
<script>
    var resizefunc = [];
</script>

<!-- jQuery  -->
<script src="./js/jquery.min.js"></script>
<script src="./js/bootstrap.min.js"></script>
<script src="./js/detect.js"></script>
<script src="./js/fastclick.js"></script>
<script src="./js/jquery.slimscroll.js"></script>
<script src="./js/jquery.blockUI.js"></script>
<!--
<script src="assets/js/waves.js"></script>
 -->
<script src="./js/wow.min.js"></script>
<script src="./js/jquery.nicescroll.js"></script>
<script src="./js/jquery.scrollTo.min.js"></script>
<script src="./js/jquery.app.js"></script>
<script src="./js/image.js"></script>
<script src="./js/common.js"></script>
<script src="./js/ajaxfileupload.js"></script>
<script src="./js/sweetalert.min.js"></script>
<script src="./js/select2.min.js" type="text/javascript"></script>
<script type="text/javascript" src="./js/jquery.multi-select.js"></script>
<script type="text/javascript" src="./js/jquery.quicksearch.js"></script>
<script type="text/javascript">
    jQuery(document).ready(function ($) {
        $.ajax({
            async: true,
            type: "POST",
            url: "http://api.51sld.cn/api/my/member-info",
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            dataType: "JSON",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("Authorization", localStorage.getItem('TOKEN_KEY_SL'));
            },
            success: function (data) {
                if (data.code == 200) {
                    console.log(data.data)
                    $('#myName').html(data.data.username)
                    $('#myPonits').html(data.data.points)
                } else {
                    toast(data.message, 1000);
                    setTimeout(() => {
                        if (data.code == 403) {
                            window.location.href = 'login.html'
                        }
                    }, 1000)
                    return;
                }
            },
            error: function () {
                toast("系统异常！", 1000);
            }
        });

        $.ajax({
            async: true,
            type: "POST",
            url: "http://api.51sld.cn/api/config/points-amount-list",
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            dataType: "JSON",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("Authorization", localStorage.getItem('TOKEN_KEY_SL'));
            },
            success: function (data) {
                if (data.code == 200) {
                    data.data.list.forEach(e => {
                        $("#points").append(`<option value="${e.id}">${e.name}</option>`)

                    })
                } else {
                    toast(data.message, 1000);
                    setTimeout(() => {
                        if (data.code == 403) {
                            window.location.href = 'login.html'
                        }
                    }, 1000)
                    return;
                }
            },
            error: function () {
                toast("系统异常！", 1000);
            }
        });


    });

    function showDetail() {
        window.location.href = "showPointsDetails.html";
    }

    function doSave() {
        var points = $("#points").val()
        console.log(points)
        if (checkParameterIsEmpty(points)) {
            toast("请选择积分", 1000);
            return;
        } else {
            localStorage.setItem('czId', points)
            window.location.href = './getPayImage.html'
		}
        // $("#pointsForm")[0].submit();
    }

    //检查值是否为空；空：返回true；不为空返回false
    function checkParameterIsEmpty(parameter) {
        if (parameter == null || parameter == "null" || parameter == "" || parameter == "undefined" || parameter == undefined) {
            return true;
        } else {
            return false;
        }
    }
</script>
<span role="status" aria-live="polite" class="select2-hidden-accessible"></span></body>
</html>
